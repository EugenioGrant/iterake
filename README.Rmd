---
output: github_document
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# iterake <img src=logo/ITERAKE_LOGO_01.png width=140 height=140 align="right" />  
**NOTE**: This package is under active development and is not yet ready to be used.
  
## Overview 

`iterake's main utility is creating row-level weights using a process called iterative raking, hence the name. Iterative raking (also known as rim weighting), is one of several methods used to correct the deviation between the *marginal* proportions in a sample from a known population, or, universe as it was first referred to (Deming & Stephan 1940) for a given set of variables.

The weighting process with `iterake` is fairly straightforward; we suggest the following workflow: 

1. Use `universe()` to build your known population. This is built with one or more weighting categories with the `marginal()` function.
2. Compare the marginal proportions in your sample with the population with `compare_margins()` function.  
3. If needed, create weights for your data using `iterake()`.  
4. Verify that the weighted proportions in your sample now match the population. The `compare_margins()` function is again used here.  
5. Check the performance of the weighting model with `weight_stats()`.

<!--
## Installation
```
# install.packages("devtools")
devtools::install_github("ttrodrigz/iterake")
```

## Motivating Example
Suppose you've sampled 200 individuals from your home town to perform a study on used car buyers. In our omniscience, we know characteristics about age, gender, and the vehicle type owned in the population from which we are sampling.

```{r, echo=FALSE, results='asis'}
age <- data.frame(
    Value = c("18-34", "35-54", "55+"),
    Pop. = c("32.0%", "35.0%", "33.0%"),
    Sample = c("34.0%", "33.5%", "32.5%")
)
gender <- data.frame(
    Value = c("Female", "Male"),
    Pop. = c("54.0%", "46.0%"),
    Sample = c("57.0%", "43.0%")
)
vehicle <- data.frame(
    Value = c("Car", "SUV", "Truck"),
    Pop. = c("38.0%", "47.0%", "15.0%"),
    Sample = c("35.5%", "51.5%", "13.0%")
)

knitr::kable(age, format = "pandoc", caption = "Age")
knitr::kable(gender, format = "pandoc", caption = "Gender")
knitr::kable(vehicle, format = "pandoc", caption = "Vehicle")
```

From the above tables, we can see there is a difference between what we collected in our sample and what is observed in the population. We can use the raking procedure to generate weights such that the weighted proportions of the sample will match (or come very close) to the population. 

Note: we do not care about the joint probabilites of our weighting categories (i.e., percent of sample who are female, own an SUV, and are over 55 years old). As mentioned earlier, raking takes only into consideration the marginal probabilities.

## Usage
This is where I realize we should be using RMarkdown/knitr so we can include code + output. Oops.
-->

